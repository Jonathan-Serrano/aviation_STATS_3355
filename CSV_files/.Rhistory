labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme(legend.title = element_blank()) +
theme_economist()+
scale_fill_economist()
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme(legend.title = element_blank()) +
theme_economist()+
scale_fill_economist()
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme(legend.title = element_blank()) +
theme_economist()+
scale_fill_economist()+
scale_color_discrete(name = "Airlines", labels = names(top_10_airlines))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme(legend.title = element_blank()) +
theme_economist()+
scale_fill_economist()+
scale_color_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines", "Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines", "United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist()+
scale_fill_economist()
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist()+
scale_fill_economist() +
scale_color_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines", "Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines", "United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist()+
scale_fill_economist() +
scale_colour_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines", "Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines", "United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
scale_colour_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines", "Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines", "United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
scale_colour_discrete(name = "Airlines")
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
scale_fill_discrete(name = "Airlines")
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines", "Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines", "United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" )) +
theme_economist() + scale_fill_economist()
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue", "blue", "darkblue", "navy", "grey"))
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" ))+
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue", "blue", "darkblue", "navy", "grey"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue", "blue", "darkblue", "navy", "grey")) +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" ))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_discrete(name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines",
"Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines",
"United Air Lines", "Southwest Airlines", "Mesa Airlines" ),
values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue", "blue", "darkblue", "navy", "grey"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() + scale_fill_economist() +
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue","blue", "darkblue", "navy", "grey"), name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() +
scale_fill_manual(values = c("lightblue", "blue", "darkblue", "navy", "grey", "lightblue","blue", "darkblue", "navy", "grey"), name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() +
scale_fill_manual(values = c("lightblue", "blue", "steelblue", "navy", "grey", "lightblue","blue", "steelblue", "navy", "grey"), name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5))
scale_fill_manual(values = c("lightblue", "blue", "steelblue", "navy", "grey", "lightblue","blue", "steelblue", "navy", "grey"), name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines"))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() +
scale_fill_manual(values = c("lightblue", "blue", "steelblue", "navy", "grey", "lightblue","blue", "steelblue", "navy", "grey"), name = "Airlines", labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air", "Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines"))
+   theme(plot.title = element_text(hjust = 0.5))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 200) +
theme_economist() +
scale_fill_manual(values = c("lightblue", "blue", "steelblue", "navy", "grey", "lightblue","blue", "steelblue", "navy", "grey"),
name = "Airlines",
labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air",
"Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines")) +
theme(plot.title = element_text(hjust = 0.5))
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
top_10_airlines <- names(sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)[1:10])
df_top_10_airlines <- no_zeros_delays[which(no_zeros_delays$OP_UNIQUE_CARRIER %in% top_10_airlines), ]
ggplot(df_top_10_airlines, aes(x = as.factor(OP_UNIQUE_CARRIER), y = DEP_DELAY_NEW, fill = as.factor(OP_UNIQUE_CARRIER))) +
geom_boxplot(outlier.shape = NA) +
labs(title = "Delay Time per Top 10 Airlines",
x = "Unique Carrier",
y = "Delay Time in Minutes") +
ylim(0, 175) +
theme_economist() +
scale_fill_manual(values = c("lightblue", "blue", "steelblue", "navy", "grey", "lightblue","blue", "steelblue", "navy", "grey"),
name = "Airlines",
labels = c("American Airlines","Delta Air Lines", "ExpressJet Airlines","Frontier Airlines", "Envoy Air",
"Spirit Air Lines", "SkyWest Airlines","United Air Lines", "Southwest Airlines", "Mesa Airlines")) +
theme(plot.title = element_text(hjust = 0.5))
median_of_delay_times_cities <- c()
for (x in dest_cities)
{
median_of_delay_times_cities <- c(median_of_delay_times_cities, median(tx_flights$DEP_DELAY_NEW[which(x == tx_flights$DEST_CITY_NAME & tx_flights$DEP_DELAY_NEW > 0)]))
}
names(median_of_delay_times_cities) <- dest_cities
sort(table(no_zeros_delays$OP_UNIQUE_CARRIER), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_STATE_NM), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME), decreasing = TRUE)
median_of_delay_times_states <- c()
for (x in dest_states)
{
median_of_delay_times_states <- c(median_of_delay_times_states, median(tx_flights$DEP_DELAY_NEW[which(x == tx_flights$DEST_STATE_NM & tx_flights$DEP_DELAY_NEW > 0)]))
}
names(median_of_delay_times_states) <- dest_states
names(median_of_delay_times_states)
sort(table(no_zeros_delays$DEST_CITY_NAME),which(state = "Texas") decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME),which(no_zeros_delays$DEST_STATE_NM), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME),which(x == no_zeros_delays$DEST_STATE_NM), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME),which(no_zeros_delays$DEST_STATE_NM == "Texas"), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME),which(no_zeros_delays$DEST_STATE_NM == "Texas"), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME,which(no_zeros_delays$DEST_STATE_NM == "Texas")), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME,which(no_zeros_delays$DEST_STATE_NM == "TX")), decreasing = TRUE)
sort(table(no_zeros_delays$DEST_CITY_NAME,which(dest_cities == "TX")), decreasing = TRUE)
for (x in length(dest_cities))
{
print(grepl("TX", dest_cities[x]))
}
dest_cities
for (x in length(dest_cities))
{
print(x)
print(grepl("TX", dest_cities[x]))
}
for (x in 1:length(dest_cities))
{
print(x)
print(grepl("TX", dest_cities[x]))
}
for (x in 1:length(dest_cities))
{
print(grepl("TX", dest_cities[x]))
}
for (x in 1:length(dest_cities))
{
append(grepl("TX", dest_cities[x]))
}
texas_cities <- c()
for (x in 1:length(dest_cities))
{
append(texas_cities, grepl("TX", dest_cities[x]))
}
texas_cities <- c()
for (x in 1:length(dest_cities))
{
texas_cities <- append(texas_cities, grepl("TX", dest_cities[x]))
}
texas_cities <- dest_cities[texas_cities]
texas_cities
texas_cities <- c()
for (x in 1:length(dest_cities))
{
texas_cities <- append(texas_cities, grepl("TX", dest_cities[x]))
}
texas_cities <- dest_cities[texas_cities]
texas_cities
texas_cities
delay_times_cities <- c()
for(x in texas_cities)
{
delay_times_cities <- c(delay_times_cities, sum(tx_flights$DEP_DELAY_NEW[which(x == tx_flights$DEST_CITY_NAME & tx_flights$DEP_DELAY_NEW > 0)]))
}
names(delay_times_cities) <- dest_cities
delay_times_cities <- c()
for(x in texas_cities)
{
delay_times_cities <- c(delay_times_cities,
count(tx_flights$DEP_DELAY_NEW[which(x == tx_flights$DEST_CITY_NAME & tx_flights$DEP_DELAY_NEW > 0)]))
}
delay_times_cities <- c()
for(x in texas_cities)
{
delay_times_cities <- c(delay_times_cities,
sum(tx_flights$DEP_DELAY_NEW[which(x == tx_flights$DEST_CITY_NAME & tx_flights$DEP_DELAY_NEW > 0)]))
}
names(delay_times_cities) <- texas_cities
ggplot(no_zeros_delays)+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), subset = .(DEST_STATE_NM %in% c("Texas")))
ggplot(no_zeros_delays)+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), subset = .(DEST_STATE_NM %in% c("Texas")), color = "steelblue")
ggplot(no_zeros_delays)+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW),, subset = .(DEST_STATE_NM %in% c("Texas")), color = "steelblue")
ggplot(no_zeros_delays)+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), ,subset = .(DEST_STATE_NM %in% c("Texas")), color = "steelblue")
ggplot(no_zeros_delays)+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), ,subset = .(DEST_CITY_NM %in% c("TX")), color = "steelblue")
ggplot(no_zeros_delays[DEST_STATE_NM %in% "Texas"])+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue")
ggplot(no_zeros_delays[DEST_STATE_NM %in% "Texas",])+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue")
ggplot(no_zeros_delays[DEST_STATE_NM %in% "Texas", ])+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue")
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue")
texas_cities
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_fill_manual(labels = c("123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456"))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_fill_discrete(labels = c("123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456"))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_color_discrete(labels = c("123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456"))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_colour_discrete(labels = c("123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456"))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456","123456"))
texas_cities
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
scale_fill_manual(name = "Count")
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
scale_fill_manual(name = "Count")
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
scale_fill_manual(name = "Count") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
scale_colour_manual(name = "Count") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_fill_discrete(name = "Counts",
labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = subset(no_zeros_delays, DEST_STATE_NM == "Texas"))+
geom_count(aes(x = DEST_CITY_NAME, y = DEP_DELAY_NEW), color = "steelblue") +
scale_x_discrete(labels = c("Abilene","Amarillo","Austin","Beaumont","Brownsville","College Station","Corpus Christi",
"Dallas","Fort Worth","Del Rio","El Paso","Harlingen","Houston","Killeen","Laredo",
"Longview","Lubbock","Midland","Mission","San Angelo","San Antonio","Tyler","Victoria",
"Waco","Wichita Falls"))+
scale_color_discrete(name = "Count") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(x = "City",
y = "Delay Time",
title = "Delay Time and Frequency based on Cities in Texas")+
theme(plot.title = element_text(hjust = 0.5))
